#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *
import ctypes
import os

LIBC = ctypes.cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')

context.update(arch="amd64", os="linux")
context.log_level = 'error'

exe = ELF('./cache_cache')

host, port = "challenge.404ctf.fr", "31946"

p = remote(host,port)

q = process('./gen')
passw = q.recvuntil('\n', drop=True)
q.close()

p.sendlineafter('identit√©:\n', 'pipo')
p.sendlineafter('passe?\n', passw)

p.interactive()

